<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nueva solicitud de muestra</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

<header class="navbar">
  <div class="navbar-inner">
    <div class="brand">
      <img src="{{ url_for('static', filename='img/logo-a3.png') }}" alt="Logo A3">
      <div class="brand-title">
        <strong>A3 Laboratorio Veterinario</strong>
        <span>Solicitud de recogida de muestras</span>
      </div>
    </div>

    <nav class="nav">
      <a class="nav-btn {{ 'active' if active=='form' else '' }}" href="{{ url_for('home') }}">Nueva solicitud</a>
      <a class="nav-btn {{ 'active' if active=='solicitudes' else '' }}" href="{{ url_for('ver_solicitudes') }}">Ver solicitudes</a>
    </nav>
  </div>
</header>

<main class="container">
  <h1>Nueva solicitud de muestra</h1>

  <section class="card">
    <form class="grid grid-vertical" method="POST" action="{{ url_for('crear_solicitud') }}">

      <!-- ===================== -->
      <!-- 1) DATOS DEL DUEÑO -->
      <!-- ===================== -->
      <div class="section-title">Datos del dueño</div>

      <label>Nombre del dueño
        <input name="dueno_nombre" placeholder="Nombre y apellido" required>
      </label>

      <label>Teléfono
        <input name="dueno_telefono" placeholder="Ej: 3001234567" required>
      </label>

      <label>Tipo de vivienda
        <select name="vivienda_tipo" id="vivienda_tipo" required>
          <option value="" selected disabled>Selecciona</option>
          <option value="casa">Casa</option>
          <option value="apto">Apartamento</option>
        </select>
      </label>

      <label>Dirección
        <input name="direccion" placeholder="Ej: Calle 97 #70-89" required>
      </label>

      <div class="row-2">
        <label>Torre (si aplica)
          <input name="torre" id="torre" placeholder="Ej: Torre 3">
        </label>

        <label>Apto (si aplica)
          <input name="apto" id="apto" placeholder="Ej: 1204">
        </label>
      </div>

      <label>Detalle / Instrucciones (portería, interior, etc.)
        <input name="direccion_detalle" placeholder="Ej: Interior 2, dejar en recepción, llamar al llegar">
      </label>

      <div class="row-2">
        <label>Turno
          <select name="horario_turno" required>
            <option value="" selected disabled>Selecciona</option>
            <option value="mañana">Mañana</option>
            <option value="tarde">Tarde</option>
          </select>
        </label>

        <label>Rango (oficina)
          <select name="horario_rango" required>
            <option value="" selected disabled>Selecciona</option>
            <option value="9:00 - 12:00">9:00 - 12:00</option>
            <option value="13:00 - 17:00">13:00 - 17:00</option>
          </select>
        </label>
      </div>

      <label>Fecha (opcional)
        <input type="date" name="fecha">
      </label>

      <!-- ===================== -->
      <!-- 2) DATOS DE LA MASCOTA -->
      <!-- ===================== -->
      <div class="section-title">Datos de la mascota</div>

      <label>Nombre de la mascota
        <input name="mascota_nombre" placeholder="Ej: Lili" required>
      </label>

      <label>Especie
        <select name="mascota_especie" id="mascota_especie" required>
          <option value="" selected disabled>Selecciona</option>
          <option value="perro">Perro</option>
          <option value="gato">Gato</option>
          <option value="otro">Otro</option>
        </select>
      </label>

      <label id="mascota_otro_wrap" class="hidden">¿Cuál?
        <input name="mascota_otro" id="mascota_otro" placeholder="Ej: Conejo, Ave, etc">
      </label>

      <label>Raza
        <input name="mascota_raza" placeholder="Ej: Criollo, Bulldog, Siamés...">
      </label>

      <label>Edad
        <input name="mascota_edad" placeholder="Ej: 2 años / 8 meses">
      </label>

      <!-- ===================== -->
      <!-- 3) MUESTRA -->
      <!-- ===================== -->
      <div class="section-title">Muestra</div>

      <label>Tipo de muestra
        <select name="muestra_tipo" id="muestra_tipo" required>
          <option value="" selected disabled>Selecciona</option>
          <option value="sangre">Sangre</option>
          <option value="heces">Heces</option>
          <option value="orina">Orina</option>
          <option value="otro">Otro</option>
        </select>
      </label>

      <label id="muestra_otro_wrap" class="hidden">¿Cuál?
        <input name="muestra_otro" id="muestra_otro" placeholder="Describe la muestra">
      </label>

      <label>Condición especial (si aplica)
        <input name="muestra_condicion" placeholder="Ej: refrigerada, entregar antes de 2h, mantener en hielo, etc">
      </label>

      <button class="btn-primary" type="submit">Enviar solicitud</button>
    </form>
  </section>
</main>

<script>
  // Mostrar/ocultar "otro" (mascota)
  const especie = document.getElementById("mascota_especie");
  const mascotaOtroWrap = document.getElementById("mascota_otro_wrap");
  const mascotaOtro = document.getElementById("mascota_otro");

  function toggleMascotaOtro(){
    const v = especie.value;
    if (v === "otro") {
      mascotaOtroWrap.classList.remove("hidden");
      mascotaOtro.required = true;
    } else {
      mascotaOtroWrap.classList.add("hidden");
      mascotaOtro.required = false;
      mascotaOtro.value = "";
    }
  }
  especie.addEventListener("change", toggleMascotaOtro);
  toggleMascotaOtro();

  // Mostrar/ocultar "otro" (muestra)
  const muestra = document.getElementById("muestra_tipo");
  const muestraOtroWrap = document.getElementById("muestra_otro_wrap");
  const muestraOtro = document.getElementById("muestra_otro");

  function toggleMuestraOtro(){
    const v = muestra.value;
    if (v === "otro") {
      muestraOtroWrap.classList.remove("hidden");
      muestraOtro.required = true;
    } else {
      muestraOtroWrap.classList.add("hidden");
      muestraOtro.required = false;
      muestraOtro.value = "";
    }
  }
  muestra.addEventListener("change", toggleMuestraOtro);
  toggleMuestraOtro();
</script>

</body>
</html>
